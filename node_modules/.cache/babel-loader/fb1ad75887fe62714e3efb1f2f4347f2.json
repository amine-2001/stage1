{"ast":null,"code":"var _jsxFileName = \"C:\\\\wamp\\\\www\\\\Projet_mediatraining_DEV\\\\mediatraining\\\\src\\\\Menu.js\";\nimport React from 'react';\nimport Tree, { TreeNode } from 'rc-tree';\nimport { gData } from './dataUtil';\n\nclass Menu extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      gData,\n      autoExpandParent: true,\n      expandedKeys: ['0-0-key', '0-0-0-key', '0-0-0-0-key']\n    };\n\n    this.onDragStart = info => {\n      console.log('start', info);\n    };\n\n    this.onDragEnter = info => {\n      console.log('enter', info);\n      this.setState({\n        expandedKeys: info.expandedKeys\n      });\n    };\n\n    this.onDrop = info => {\n      console.log('drop', info);\n      const dropKey = info.node.props.eventKey;\n      const dragKey = info.dragNode.props.eventKey;\n      const dropPos = info.node.props.pos.split('-');\n      const dropPosition = info.dropPosition - Number(dropPos[dropPos.length - 1]);\n\n      const loop = (data, key, callback) => {\n        data.forEach((item, index, arr) => {\n          if (item.key === key) {\n            callback(item, index, arr);\n            return;\n          }\n\n          if (item.children) {\n            loop(item.children, key, callback);\n          }\n        });\n      };\n\n      const data = [...this.state.gData]; // Find dragObject\n\n      let dragObj;\n      loop(data, dragKey, (item, index, arr) => {\n        arr.splice(index, 1);\n        dragObj = item;\n      });\n\n      if (!info.dropToGap) {\n        // Drop on the content\n        loop(data, dropKey, item => {\n          // eslint-disable-next-line no-param-reassign\n          item.children = item.children || []; // where to insert 示例添加到尾部，可以是随意位置\n\n          item.children.push(dragObj);\n        });\n      } else if ((info.node.props.children || []).length > 0 && // Has children\n      info.node.props.expanded && // Is expanded\n      dropPosition === 1 // On the bottom gap\n      ) {\n          loop(data, dropKey, item => {\n            // eslint-disable-next-line no-param-reassign\n            item.children = item.children || []; // where to insert 示例添加到尾部，可以是随意位置\n\n            item.children.unshift(dragObj);\n          });\n        } else {\n        // Drop on the gap\n        let ar;\n        let i;\n        loop(data, dropKey, (item, index, arr) => {\n          ar = arr;\n          i = index;\n        });\n\n        if (dropPosition === -1) {\n          ar.splice(i, 0, dragObj);\n        } else {\n          ar.splice(i + 1, 0, dragObj);\n        }\n      }\n\n      this.setState({\n        gData: data\n      });\n    };\n\n    this.onExpand = expandedKeys => {\n      console.log('onExpand', expandedKeys);\n      this.setState({\n        expandedKeys,\n        autoExpandParent: false\n      });\n    };\n  }\n\n  render() {\n    const loop = data => data.map(item => {\n      if (item.children && item.children.length) {\n        return React.createElement(TreeNode, {\n          key: item.key,\n          title: item.title,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 102\n          },\n          __self: this\n        }, loop(item.children));\n      }\n\n      return React.createElement(TreeNode, {\n        key: item.key,\n        title: item.title,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      });\n    });\n\n    return React.createElement(\"div\", {\n      className: \"draggable-demo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, \"draggable\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"drag a node into another node\"), React.createElement(\"div\", {\n      className: \"draggable-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(Tree, {\n      expandedKeys: this.state.expandedKeys,\n      onExpand: this.onExpand,\n      autoExpandParent: this.state.autoExpandParent,\n      draggable: true,\n      onDragStart: this.onDragStart,\n      onDragEnter: this.onDragEnter,\n      onDrop: this.onDrop,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, loop(this.state.gData))));\n  }\n\n}\n\nexport default Menu;","map":{"version":3,"sources":["C:/wamp/www/Projet_mediatraining_DEV/mediatraining/src/Menu.js"],"names":["React","Tree","TreeNode","gData","Menu","Component","state","autoExpandParent","expandedKeys","onDragStart","info","console","log","onDragEnter","setState","onDrop","dropKey","node","props","eventKey","dragKey","dragNode","dropPos","pos","split","dropPosition","Number","length","loop","data","key","callback","forEach","item","index","arr","children","dragObj","splice","dropToGap","push","expanded","unshift","ar","i","onExpand","render","map","title"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Tree, { TreeNode } from 'rc-tree';\r\nimport { gData } from './dataUtil'\r\n\r\nclass Menu extends React.Component {\r\n    state = {\r\n      gData,\r\n      autoExpandParent: true,\r\n      expandedKeys: ['0-0-key', '0-0-0-key', '0-0-0-0-key'],\r\n    };\r\n  \r\n    onDragStart = info => {\r\n      console.log('start', info);\r\n    };\r\n  \r\n    onDragEnter = info => {\r\n      console.log('enter', info);\r\n      this.setState({\r\n        expandedKeys: info.expandedKeys,\r\n      });\r\n    };\r\n  \r\n    onDrop = info => {\r\n      console.log('drop', info);\r\n      const dropKey = info.node.props.eventKey;\r\n      const dragKey = info.dragNode.props.eventKey;\r\n      const dropPos = info.node.props.pos.split('-');\r\n      const dropPosition = info.dropPosition - Number(dropPos[dropPos.length - 1]);\r\n  \r\n      const loop = (data, key, callback) => {\r\n        data.forEach((item, index, arr) => {\r\n          if (item.key === key) {\r\n            callback(item, index, arr);\r\n            return;\r\n          }\r\n          if (item.children) {\r\n            loop(item.children, key, callback);\r\n          }\r\n        });\r\n      };\r\n      const data = [...this.state.gData];\r\n  \r\n      // Find dragObject\r\n      let dragObj;\r\n      loop(data, dragKey, (item, index, arr) => {\r\n        arr.splice(index, 1);\r\n        dragObj = item;\r\n      });\r\n  \r\n      if (!info.dropToGap) {\r\n        // Drop on the content\r\n        loop(data, dropKey, item => {\r\n          // eslint-disable-next-line no-param-reassign\r\n          item.children = item.children || [];\r\n          // where to insert 示例添加到尾部，可以是随意位置\r\n          item.children.push(dragObj);\r\n        });\r\n      } else if (\r\n        (info.node.props.children || []).length > 0 && // Has children\r\n        info.node.props.expanded && // Is expanded\r\n        dropPosition === 1 // On the bottom gap\r\n      ) {\r\n        loop(data, dropKey, item => {\r\n          // eslint-disable-next-line no-param-reassign\r\n          item.children = item.children || [];\r\n          // where to insert 示例添加到尾部，可以是随意位置\r\n          item.children.unshift(dragObj);\r\n        });\r\n      } else {\r\n        // Drop on the gap\r\n        let ar;\r\n        let i;\r\n        loop(data, dropKey, (item, index, arr) => {\r\n          ar = arr;\r\n          i = index;\r\n        });\r\n        if (dropPosition === -1) {\r\n          ar.splice(i, 0, dragObj);\r\n        } else {\r\n          ar.splice(i + 1, 0, dragObj);\r\n        }\r\n      }\r\n  \r\n      this.setState({\r\n        gData: data,\r\n      });\r\n    };\r\n  \r\n    onExpand = expandedKeys => {\r\n      console.log('onExpand', expandedKeys);\r\n      this.setState({\r\n        expandedKeys,\r\n        autoExpandParent: false,\r\n      });\r\n    };\r\n  \r\n    render() {\r\n      const loop = data =>\r\n        data.map(item => {\r\n          if (item.children && item.children.length) {\r\n            return (\r\n              <TreeNode key={item.key} title={item.title}>\r\n                {loop(item.children)}\r\n              </TreeNode>\r\n            );\r\n          }\r\n          return <TreeNode key={item.key} title={item.title} />;\r\n        });\r\n      return (\r\n        <div className=\"draggable-demo\">\r\n          <h2>draggable</h2>\r\n          <p>drag a node into another node</p>\r\n          <div className=\"draggable-container\">\r\n            <Tree\r\n              expandedKeys={this.state.expandedKeys}\r\n              onExpand={this.onExpand}\r\n              autoExpandParent={this.state.autoExpandParent}\r\n              draggable\r\n              onDragStart={this.onDragStart}\r\n              onDragEnter={this.onDragEnter}\r\n              onDrop={this.onDrop}\r\n            >\r\n              {loop(this.state.gData)}\r\n            </Tree>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\nexport default Menu;\r\n\r\n"]},"metadata":{},"sourceType":"module"}