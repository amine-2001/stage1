{"ast":null,"code":"var _jsxFileName = \"C:\\\\wamp\\\\www\\\\Projet_mediatraining_DEV\\\\mediatraining\\\\src\\\\Permissions.js\";\nimport React, { Component } from 'react';\nimport { Link, BrowserRouter as Router, Route, Switch, withRouter } from 'react-router-dom';\nimport axios from 'axios';\nimport jQuery from 'jquery';\n\nclass Permissions extends Component {\n  constructor(props) {\n    super(props);\n\n    this.modif = () => {\n      ///\n      var canAdd = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n      var canRead = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n      var canUpdate = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n      var canDelete = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]; ///\n\n      var ajout = document.getElementsByClassName('add');\n      var explorer = document.getElementsByClassName('view');\n      var modifier = document.getElementsByClassName('Update');\n      var supprimer = document.getElementsByClassName('delet');\n      var longeur = this.state.services.length;\n      var tabPermission = [];\n\n      for (var i = 0; i < longeur; i++) {\n        if (ajout[i].checked) {\n          canAdd[i] = 1;\n        } else if (ajout[i].checked === false) {\n          canAdd[i] = 0;\n        }\n\n        if (explorer[i].checked) {\n          canRead[i] = 1;\n        } else if (explorer[i].checked === false) {\n          canRead[i] = 0;\n        }\n\n        if (modifier[i].checked) {\n          canUpdate[i] = 1;\n        } else if (modifier[i].checked === false) {\n          canUpdate[i] = 0;\n        }\n\n        if (supprimer[i].checked) {\n          canDelete[i] = 1;\n        } else if (supprimer[i].checked === false) {\n          canDelete[i] = 0;\n        }\n\n        var idRole = this.props.location.state.idRole;\n        var objetPermission = {\n          service_id: this.state.services[i].id,\n          role_id: idRole,\n          ajouter: canAdd[i],\n          explorer: canRead[i],\n          modifier: canUpdate[i],\n          supprimer: canDelete[i]\n        };\n        console.log(objetPermission);\n        tabPermission.push(objetPermission);\n      }\n\n      console.log(tabPermission);\n      jQuery.ajax({\n        url: process.env.REACT_APP_API_URL + 'Back_mediatraining/UpdPermissionByRoleId.php?id=' + idRole,\n        type: 'POST',\n        data: {\n          tabPermission: tabPermission\n        },\n        dataType: 'json',\n        success: (code_html, statut) => {\n          if (code_html.Result === \"OK\") {\n            this.props.history.push('/Roles');\n          } else if (code_html.Result === \"KO\") {\n            alert(\"erreur,l'un de vos champs est vide!!\");\n          }\n        }\n      });\n    };\n\n    this.state = {\n      services: [],\n      permissions: [],\n      role: ''\n    };\n  }\n\n  componentDidMount() {\n    if (JSON.parse(localStorage.getItem('userPermissions')) != null) {\n      axios.get(process.env.REACT_APP_API_URL + 'Back_mediatraining/Services.php').then(res => {\n        this.setState({\n          services: res.data\n        }, () => {\n          let idRole = this.props.location.state.idRole;\n          axios.get(process.env.REACT_APP_API_URL + 'Back_mediatraining/GetPermissionByRoleId.php?id=' + idRole).then(res => {\n            this.setState({\n              role: res.data[0].role,\n              permissions: res.data\n            }, () => {\n              var long = this.state.permissions.length;\n              var ajout = document.getElementsByClassName('add');\n              console.log(ajout);\n              var addCan = [];\n              var explorer = document.getElementsByClassName('view');\n              console.log(explorer);\n              var readCan = [];\n              var modifier = document.getElementsByClassName('Update');\n              console.log(modifier);\n              var updateCan = [];\n              var supprimer = document.getElementsByClassName('delet');\n              console.log(supprimer);\n              var deleteCan = [];\n\n              for (var i = 0; i < long; i++) {\n                addCan.push(this.state.permissions[i].ajouter);\n                readCan.push(this.state.permissions[i].explorer);\n                updateCan.push(this.state.permissions[i].modifier);\n                deleteCan.push(this.state.permissions[i].supprimer);\n              }\n\n              console.log('le tableau addCan');\n              console.log(addCan);\n              console.log('le tableau readCan');\n              console.log(readCan);\n              console.log('le tableau updateCan');\n              console.log(updateCan);\n              console.log('le tableau deleteCan');\n              console.log(deleteCan);\n\n              for (var j = 0; j < long; j++) {\n                if (addCan[j] == 1) {\n                  ajout[j].checked = true;\n                } else if (addCan[j] == 0) {\n                  ajout[j].checked = false;\n                }\n\n                if (readCan[j] == 1) {\n                  explorer[j].checked = true;\n                } else if (readCan[j] == 0) {\n                  explorer[j].checked = false;\n                }\n\n                if (updateCan[j] == 1) {\n                  modifier[j].checked = true;\n                } else if (updateCan[j] == 0) {\n                  modifier[j].checked = false;\n                }\n\n                if (deleteCan[j] == 1) {\n                  supprimer[j].checked = true;\n                } else if (deleteCan[j] == 0) {\n                  supprimer[j].checked = false;\n                }\n              }\n            });\n          });\n        });\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      id: \"page-wrapper\",\n      style: {\n        minHeight: '263px',\n        marginLeft: '0px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row bg-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-lg-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"page-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, \"Modification permissions\"))), React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-sm-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'flex-start',\n        alignItems: 'center',\n        marginBottom: '10px',\n        marginLeft: '5px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      style: {\n        fontSize: '20px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, \"Role : \", this.state.role)), React.createElement(\"div\", {\n      className: \"white-box\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"table-responsive\",\n      style: {\n        textAlign: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      className: \"table align-items-center table-flush\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      className: \"thead-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      style: {\n        textAlign: 'center'\n      },\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, \"Services\"), React.createElement(\"th\", {\n      style: {\n        textAlign: 'center'\n      },\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, \"Ajouter\"), React.createElement(\"th\", {\n      style: {\n        textAlign: 'center'\n      },\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, \"Explorer\"), React.createElement(\"th\", {\n      style: {\n        textAlign: 'center'\n      },\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, \"Modifier\"), React.createElement(\"th\", {\n      style: {\n        textAlign: 'center'\n      },\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, \"Supprimer\"))), this.state.services.map(el => React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, el.service), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"add\",\n      type: \"checkbox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    })), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"view\",\n      type: \"checkbox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    })), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"Update\",\n      type: \"checkbox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    })), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"delet\",\n      type: \"checkbox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }))))))), React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        marginBottom: '10px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      style: {\n        width: '15%',\n        borderRadius: '5px'\n      },\n      type: \"button\",\n      className: \"btn btn-success\",\n      onClick: this.modif,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, \"Confirmer\"))))))));\n  }\n\n}\n\nexport default withRouter(Permissions);","map":{"version":3,"sources":["C:/wamp/www/Projet_mediatraining_DEV/mediatraining/src/Permissions.js"],"names":["React","Component","Link","BrowserRouter","Router","Route","Switch","withRouter","axios","jQuery","Permissions","constructor","props","modif","canAdd","canRead","canUpdate","canDelete","ajout","document","getElementsByClassName","explorer","modifier","supprimer","longeur","state","services","length","tabPermission","i","checked","idRole","location","objetPermission","service_id","id","role_id","ajouter","console","log","push","ajax","url","process","env","REACT_APP_API_URL","type","data","dataType","success","code_html","statut","Result","history","alert","permissions","role","componentDidMount","JSON","parse","localStorage","getItem","get","then","res","setState","long","addCan","readCan","updateCan","deleteCan","j","render","minHeight","marginLeft","display","justifyContent","alignItems","marginBottom","fontSize","textAlign","map","el","service","width","borderRadius"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Link, BrowserRouter as Router, Route, Switch, withRouter } from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport jQuery from 'jquery'\r\n\r\nclass Permissions extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            services: [],\r\n            permissions: [],\r\n            role: ''\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (JSON.parse((localStorage.getItem('userPermissions'))) != null) {\r\n            axios.get(process.env.REACT_APP_API_URL + 'Back_mediatraining/Services.php').then(res => {\r\n                this.setState({ services: res.data }, () => {\r\n                    let idRole = this.props.location.state.idRole;\r\n                    axios.get(process.env.REACT_APP_API_URL + 'Back_mediatraining/GetPermissionByRoleId.php?id=' + idRole).then(res => {\r\n                        this.setState({\r\n                            role: res.data[0].role,\r\n                            permissions: res.data\r\n                        },\r\n                            () => {\r\n                                var long = this.state.permissions.length\r\n                                var ajout = document.getElementsByClassName('add')\r\n                                console.log(ajout)\r\n                                var addCan = []\r\n                                var explorer = document.getElementsByClassName('view')\r\n                                console.log(explorer)\r\n                                var readCan = []\r\n                                var modifier = document.getElementsByClassName('Update')\r\n                                console.log(modifier)\r\n                                var updateCan = []\r\n                                var supprimer = document.getElementsByClassName('delet')\r\n                                console.log(supprimer)\r\n                                var deleteCan = []\r\n\r\n                                for (var i = 0; i < long; i++) {\r\n                                    addCan.push(this.state.permissions[i].ajouter)\r\n                                    readCan.push(this.state.permissions[i].explorer)\r\n                                    updateCan.push(this.state.permissions[i].modifier)\r\n                                    deleteCan.push(this.state.permissions[i].supprimer)\r\n                                }\r\n\r\n                                console.log('le tableau addCan')\r\n                                console.log(addCan)\r\n                                console.log('le tableau readCan')\r\n                                console.log(readCan)\r\n                                console.log('le tableau updateCan')\r\n                                console.log(updateCan)\r\n                                console.log('le tableau deleteCan')\r\n                                console.log(deleteCan)\r\n\r\n                                for (var j = 0; j < long; j++) {\r\n                                    if (addCan[j] == 1) {\r\n                                        ajout[j].checked = true\r\n                                    }\r\n                                    else if (addCan[j] == 0) {\r\n                                        ajout[j].checked = false\r\n                                    }\r\n                                    if (readCan[j] == 1) {\r\n                                        explorer[j].checked = true\r\n                                    }\r\n                                    else if (readCan[j] == 0) {\r\n                                        explorer[j].checked = false\r\n                                    }\r\n                                    if (updateCan[j] == 1) {\r\n                                        modifier[j].checked = true\r\n                                    }\r\n                                    else if (updateCan[j] == 0) {\r\n                                        modifier[j].checked = false\r\n                                    }\r\n                                    if (deleteCan[j] == 1) {\r\n                                        supprimer[j].checked = true\r\n                                    }\r\n                                    else if (deleteCan[j] == 0) {\r\n                                        supprimer[j].checked = false\r\n                                    }\r\n                                }\r\n                            }\r\n                        );\r\n                    });\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    modif = () => {\r\n        ///\r\n        var canAdd = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        var canRead = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        var canUpdate = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        var canDelete = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        ///\r\n        var ajout = document.getElementsByClassName('add')\r\n        var explorer = document.getElementsByClassName('view')\r\n        var modifier = document.getElementsByClassName('Update')\r\n        var supprimer = document.getElementsByClassName('delet')\r\n        var longeur = this.state.services.length\r\n        var tabPermission = []\r\n\r\n        for (var i = 0; i < longeur; i++) {\r\n            if (ajout[i].checked) {\r\n                canAdd[i] = 1\r\n            }\r\n            else if (ajout[i].checked === false) {\r\n                canAdd[i] = 0\r\n            }\r\n            if (explorer[i].checked) {\r\n                canRead[i] = 1\r\n            }\r\n            else if (explorer[i].checked === false) {\r\n                canRead[i] = 0\r\n            }\r\n            if (modifier[i].checked) {\r\n                canUpdate[i] = 1\r\n            }\r\n            else if (modifier[i].checked === false) {\r\n                canUpdate[i] = 0\r\n            }\r\n            if (supprimer[i].checked) {\r\n                canDelete[i] = 1\r\n            }\r\n            else if (supprimer[i].checked === false) {\r\n                canDelete[i] = 0\r\n            }\r\n\r\n            var idRole = this.props.location.state.idRole;\r\n            var objetPermission = { service_id: this.state.services[i].id, role_id: idRole, ajouter: canAdd[i], explorer: canRead[i], modifier: canUpdate[i], supprimer: canDelete[i] }\r\n            console.log(objetPermission)\r\n            tabPermission.push(objetPermission)\r\n        }\r\n        console.log(tabPermission)\r\n\r\n        jQuery.ajax({\r\n            url: process.env.REACT_APP_API_URL + 'Back_mediatraining/UpdPermissionByRoleId.php?id=' + idRole,\r\n            type: 'POST',\r\n            data: {\r\n                tabPermission: tabPermission\r\n            },\r\n            dataType: 'json',\r\n            success: (code_html, statut) => {\r\n                if (code_html.Result === \"OK\") {\r\n                    this.props.history.push('/Roles');\r\n                }\r\n                else if (code_html.Result === \"KO\") {\r\n                    alert(\"erreur,l'un de vos champs est vide!!\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div id=\"page-wrapper\" style={{ minHeight: '263px',marginLeft:'0px' }}>\r\n                <div className=\"container-fluid\">\r\n                    <div className=\"row bg-title\">\r\n                        <div className=\"col-lg-12\">\r\n                            <h4 className=\"page-title\">Modification permissions</h4>\r\n                        </div>\r\n                        {/* /.col-lg-12 */}\r\n                    </div>\r\n                    {/* /.row */}\r\n                    <div className=\"row\">\r\n                        <div className=\"col-sm-12\">\r\n                            <div style={{ display: 'flex', justifyContent: 'flex-start', alignItems: 'center', marginBottom: '10px', marginLeft: '5px' }}>\r\n                                <h4 style={{ fontSize: '20px' }}>Role : {this.state.role}</h4>\r\n                            </div>\r\n                            <div className=\"white-box\">\r\n                                <div className=\"row\">\r\n                                    <div className=\"table-responsive\" style={{ textAlign: 'center' }}>\r\n                                        <table className=\"table align-items-center table-flush\">\r\n                                            <thead className=\"thead-light\">\r\n                                                <tr>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Services</th>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Ajouter</th>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Explorer</th>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Modifier</th>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Supprimer</th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            {this.state.services.map(el =>\r\n                                                <tbody>\r\n                                                    <tr>\r\n                                                        <td>\r\n                                                            {el.service}\r\n                                                        </td>\r\n                                                        <td>\r\n                                                            <input className='add' type=\"checkbox\" />\r\n                                                        </td>\r\n                                                        <td>\r\n                                                            <input className='view' type=\"checkbox\" />\r\n                                                        </td>\r\n                                                        <td>\r\n                                                            <input className='Update' type=\"checkbox\" />\r\n                                                        </td>\r\n                                                        <td>\r\n                                                            <input className='delet' type=\"checkbox\" />\r\n                                                        </td>\r\n                                                    </tr>\r\n                                                </tbody>\r\n                                            )}\r\n                                        </table>\r\n                                    </div>\r\n                                    <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '10px' }}>\r\n                                        <button style={{ width: '15%', borderRadius: '5px' }} type=\"button\" className=\"btn btn-success\" onClick={this.modif}>Confirmer</button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(Permissions);"]},"metadata":{},"sourceType":"module"}