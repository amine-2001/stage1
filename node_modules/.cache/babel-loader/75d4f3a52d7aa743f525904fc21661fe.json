{"ast":null,"code":"var _jsxFileName = \"C:\\\\wamp\\\\www\\\\Projet_mediatraining_DEV\\\\mediatraining\\\\src\\\\Menu.js\";\nimport React from 'react';\nimport Tree from 'rc-tree';\nimport { gData } from './dataUtil';\nimport './index.less';\nconst STYLE = `\n.rc-tree-child-tree {\n  display: block;\n}\n\n.node-motion {\n  transition: all .3s;\n  overflow-y: hidden;\n}\n`;\nconst motion = {\n  motionName: 'node-motion',\n  motionAppear: false,\n  onAppearStart: node => {\n    console.log('Start Motion:', node);\n    return {\n      height: 0\n    };\n  },\n  onAppearActive: node => ({\n    height: node.scrollHeight\n  }),\n  onLeaveStart: node => ({\n    height: node.offsetHeight\n  }),\n  onLeaveActive: () => ({\n    height: 0\n  })\n}; // const gData = [\n//   { title: '0-0', key: '0-0' },\n//   { title: '0-1', key: '0-1' },\n//   { title: '0-2', key: '0-2', children: [{ title: '0-2-0', key: '0-2-0' }] },\n// ];\n\nclass Menu extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      gData,\n      autoExpandParent: true,\n      expandedKeys: ['0-0-key', '0-0-0-key', '0-0-0-0-key']\n    };\n\n    this.onDragEnter = ({\n      expandedKeys\n    }) => {\n      console.log('enter', expandedKeys);\n      this.setState({\n        expandedKeys\n      });\n    };\n\n    this.onDrop = info => {\n      console.log('drop', info);\n      const dropKey = info.node.props.eventKey;\n      const dragKey = info.dragNode.props.eventKey;\n      const dropPos = info.node.props.pos.split('-');\n      const dropPosition = info.dropPosition - Number(dropPos[dropPos.length - 1]);\n\n      const loop = (data, key, callback) => {\n        data.forEach((item, index, arr) => {\n          if (item.key === key) {\n            callback(item, index, arr);\n            return;\n          }\n\n          if (item.children) {\n            loop(item.children, key, callback);\n          }\n        });\n      };\n\n      const data = [...this.state.gData]; // Find dragObject\n\n      let dragObj;\n      loop(data, dragKey, (item, index, arr) => {\n        arr.splice(index, 1);\n        dragObj = item;\n      });\n\n      if (!info.dropToGap) {\n        // Drop on the content\n        loop(data, dropKey, item => {\n          item.children = item.children || []; // where to insert 示例添加到尾部，可以是随意位置\n\n          item.children.push(dragObj);\n        });\n      } else if ((info.node.props.children || []).length > 0 && // Has children\n      info.node.props.expanded && // Is expanded\n      dropPosition === 1 // On the bottom gap\n      ) {\n          loop(data, dropKey, item => {\n            item.children = item.children || []; // where to insert 示例添加到尾部，可以是随意位置\n\n            item.children.unshift(dragObj);\n          });\n        } else {\n        // Drop on the gap\n        let ar;\n        let i;\n        loop(data, dropKey, (item, index, arr) => {\n          ar = arr;\n          i = index;\n        });\n\n        if (dropPosition === -1) {\n          ar.splice(i, 0, dragObj);\n        } else {\n          ar.splice(i + 1, 0, dragObj);\n        }\n      }\n\n      this.setState({\n        gData: data\n      });\n    };\n\n    this.onExpand = expandedKeys => {\n      console.log('onExpand', expandedKeys);\n      this.setState({\n        expandedKeys,\n        autoExpandParent: false\n      });\n    };\n  }\n\n  render() {\n    const {\n      expandedKeys\n    } = this.state;\n    return React.createElement(\"div\", {\n      className: \"draggable-demo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(\"style\", {\n      dangerouslySetInnerHTML: {\n        __html: STYLE\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }), React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"draggable\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, \"drag a node into another node\"), React.createElement(Tree, {\n      expandedKeys: expandedKeys,\n      onExpand: this.onExpand,\n      autoExpandParent: this.state.autoExpandParent,\n      draggable: true,\n      onDragStart: this.onDragStart,\n      onDragEnter: this.onDragEnter,\n      onDrop: this.onDrop,\n      treeData: this.state.gData,\n      motion: motion,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Menu;","map":{"version":3,"sources":["C:/wamp/www/Projet_mediatraining_DEV/mediatraining/src/Menu.js"],"names":["React","Tree","gData","STYLE","motion","motionName","motionAppear","onAppearStart","node","console","log","height","onAppearActive","scrollHeight","onLeaveStart","offsetHeight","onLeaveActive","Menu","Component","state","autoExpandParent","expandedKeys","onDragEnter","setState","onDrop","info","dropKey","props","eventKey","dragKey","dragNode","dropPos","pos","split","dropPosition","Number","length","loop","data","key","callback","forEach","item","index","arr","children","dragObj","splice","dropToGap","push","expanded","unshift","ar","i","onExpand","render","__html","onDragStart"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Tree from 'rc-tree';\r\nimport { gData } from './dataUtil'\r\nimport './index.less';\r\n\r\nconst STYLE = `\r\n.rc-tree-child-tree {\r\n  display: block;\r\n}\r\n\r\n.node-motion {\r\n  transition: all .3s;\r\n  overflow-y: hidden;\r\n}\r\n`;\r\n\r\nconst motion = {\r\n    motionName: 'node-motion',\r\n    motionAppear: false,\r\n    onAppearStart: node => {\r\n        console.log('Start Motion:', node);\r\n        return { height: 0 };\r\n    },\r\n    onAppearActive: node => ({ height: node.scrollHeight }),\r\n    onLeaveStart: node => ({ height: node.offsetHeight }),\r\n    onLeaveActive: () => ({ height: 0 }),\r\n};\r\n\r\n// const gData = [\r\n//   { title: '0-0', key: '0-0' },\r\n//   { title: '0-1', key: '0-1' },\r\n//   { title: '0-2', key: '0-2', children: [{ title: '0-2-0', key: '0-2-0' }] },\r\n// ];\r\n\r\nclass Menu extends React.Component {\r\n    state = {\r\n        gData,\r\n        autoExpandParent: true,\r\n        expandedKeys: ['0-0-key', '0-0-0-key', '0-0-0-0-key'],\r\n    };\r\n\r\n    onDragEnter = ({ expandedKeys }) => {\r\n        console.log('enter', expandedKeys);\r\n        this.setState({\r\n            expandedKeys,\r\n        });\r\n    };\r\n\r\n    onDrop = info => {\r\n        console.log('drop', info);\r\n        const dropKey = info.node.props.eventKey;\r\n        const dragKey = info.dragNode.props.eventKey;\r\n        const dropPos = info.node.props.pos.split('-');\r\n        const dropPosition = info.dropPosition - Number(dropPos[dropPos.length - 1]);\r\n\r\n        const loop = (data, key, callback) => {\r\n            data.forEach((item, index, arr) => {\r\n                if (item.key === key) {\r\n                    callback(item, index, arr);\r\n                    return;\r\n                }\r\n                if (item.children) {\r\n                    loop(item.children, key, callback);\r\n                }\r\n            });\r\n        };\r\n        const data = [...this.state.gData];\r\n\r\n        // Find dragObject\r\n        let dragObj;\r\n        loop(data, dragKey, (item, index, arr) => {\r\n            arr.splice(index, 1);\r\n            dragObj = item;\r\n        });\r\n\r\n        if (!info.dropToGap) {\r\n            // Drop on the content\r\n            loop(data, dropKey, item => {\r\n                item.children = item.children || [];\r\n                // where to insert 示例添加到尾部，可以是随意位置\r\n                item.children.push(dragObj);\r\n            });\r\n        } else if (\r\n            (info.node.props.children || []).length > 0 && // Has children\r\n            info.node.props.expanded && // Is expanded\r\n            dropPosition === 1 // On the bottom gap\r\n        ) {\r\n            loop(data, dropKey, item => {\r\n                item.children = item.children || [];\r\n                // where to insert 示例添加到尾部，可以是随意位置\r\n                item.children.unshift(dragObj);\r\n            });\r\n        } else {\r\n            // Drop on the gap\r\n            let ar;\r\n            let i;\r\n            loop(data, dropKey, (item, index, arr) => {\r\n                ar = arr;\r\n                i = index;\r\n            });\r\n            if (dropPosition === -1) {\r\n                ar.splice(i, 0, dragObj);\r\n            } else {\r\n                ar.splice(i + 1, 0, dragObj);\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            gData: data,\r\n        });\r\n    };\r\n\r\n    onExpand = expandedKeys => {\r\n        console.log('onExpand', expandedKeys);\r\n        this.setState({\r\n            expandedKeys,\r\n            autoExpandParent: false,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        const { expandedKeys } = this.state;\r\n\r\n        return (\r\n            <div className=\"draggable-demo\">\r\n                <style dangerouslySetInnerHTML={{ __html: STYLE }} />\r\n\r\n                <h2>draggable</h2>\r\n                <p>drag a node into another node</p>\r\n                <Tree\r\n                    expandedKeys={expandedKeys}\r\n                    onExpand={this.onExpand}\r\n                    autoExpandParent={this.state.autoExpandParent}\r\n                    draggable\r\n                    onDragStart={this.onDragStart}\r\n                    onDragEnter={this.onDragEnter}\r\n                    onDrop={this.onDrop}\r\n                    treeData={this.state.gData}\r\n                    motion={motion}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Menu;\r\n\r\n"]},"metadata":{},"sourceType":"module"}