{"ast":null,"code":"import _classCallCheck from\"C:\\\\wamp\\\\www\\\\art_metiers_prod\\\\mediatraining\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\wamp\\\\www\\\\art_metiers_prod\\\\mediatraining\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\wamp\\\\www\\\\art_metiers_prod\\\\mediatraining\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\wamp\\\\www\\\\art_metiers_prod\\\\mediatraining\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\wamp\\\\www\\\\art_metiers_prod\\\\mediatraining\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Link,BrowserRouter as Router,Route,Switch,withRouter}from'react-router-dom';import axios from'axios';import jQuery from'jquery';var Permissions=/*#__PURE__*/function(_Component){_inherits(Permissions,_Component);function Permissions(props){var _this;_classCallCheck(this,Permissions);_this=_possibleConstructorReturn(this,_getPrototypeOf(Permissions).call(this,props));_this.modif=function(){///\nvar canAdd=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var canRead=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var canUpdate=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var canDelete=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];///\nvar ajout=document.getElementsByClassName('add');var explorer=document.getElementsByClassName('view');var modifier=document.getElementsByClassName('Update');var supprimer=document.getElementsByClassName('delet');var longeur=_this.state.services.length;var tabPermission=[];for(var i=0;i<longeur;i++){if(ajout[i].checked){canAdd[i]=1;}else if(ajout[i].checked===false){canAdd[i]=0;}if(explorer[i].checked){canRead[i]=1;}else if(explorer[i].checked===false){canRead[i]=0;}if(modifier[i].checked){canUpdate[i]=1;}else if(modifier[i].checked===false){canUpdate[i]=0;}if(supprimer[i].checked){canDelete[i]=1;}else if(supprimer[i].checked===false){canDelete[i]=0;}var idRole=_this.props.location.state.idRole;var objetPermission={service_id:_this.state.services[i].id,role_id:idRole,ajouter:canAdd[i],explorer:canRead[i],modifier:canUpdate[i],supprimer:canDelete[i]};console.log(objetPermission);tabPermission.push(objetPermission);}console.log(tabPermission);jQuery.ajax({url:process.env.REACT_APP_API_URL+'Back_mediatraining/UpdPermissionByRoleId.php?id='+idRole,type:'POST',data:{tabPermission:tabPermission},dataType:'json',success:function success(code_html,statut){if(code_html.Result===\"OK\"){_this.props.history.push('/Roles');}else if(code_html.Result===\"KO\"){alert(\"erreur,l'un de vos champs est vide!!\");}}});};_this.state={services:[],permissions:[],role:''};return _this;}_createClass(Permissions,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(JSON.parse(localStorage.getItem('userPermissions'))!=null){axios.get(process.env.REACT_APP_API_URL+'Back_mediatraining/Services.php').then(function(res){_this2.setState({services:res.data},function(){var idRole=_this2.props.location.state.idRole;axios.get(process.env.REACT_APP_API_URL+'Back_mediatraining/GetPermissionByRoleId.php?id='+idRole).then(function(res){_this2.setState({role:res.data[0].role,permissions:res.data},function(){var long=_this2.state.permissions.length;var ajout=document.getElementsByClassName('add');console.log(ajout);var addCan=[];var explorer=document.getElementsByClassName('view');console.log(explorer);var readCan=[];var modifier=document.getElementsByClassName('Update');console.log(modifier);var updateCan=[];var supprimer=document.getElementsByClassName('delet');console.log(supprimer);var deleteCan=[];for(var i=0;i<long;i++){addCan.push(_this2.state.permissions[i].ajouter);readCan.push(_this2.state.permissions[i].explorer);updateCan.push(_this2.state.permissions[i].modifier);deleteCan.push(_this2.state.permissions[i].supprimer);}console.log('le tableau addCan');console.log(addCan);console.log('le tableau readCan');console.log(readCan);console.log('le tableau updateCan');console.log(updateCan);console.log('le tableau deleteCan');console.log(deleteCan);for(var j=0;j<long;j++){if(addCan[j]==1){ajout[j].checked=true;}else if(addCan[j]==0){ajout[j].checked=false;}if(readCan[j]==1){explorer[j].checked=true;}else if(readCan[j]==0){explorer[j].checked=false;}if(updateCan[j]==1){modifier[j].checked=true;}else if(updateCan[j]==0){modifier[j].checked=false;}if(deleteCan[j]==1){supprimer[j].checked=true;}else if(deleteCan[j]==0){supprimer[j].checked=false;}}});});});});}}},{key:\"render\",value:function render(){return React.createElement(\"div\",{id:\"page-wrapper\",style:{minHeight:'263px',marginLeft:'0px'}},React.createElement(\"div\",{className:\"container-fluid\"},React.createElement(\"div\",{className:\"row bg-title\"},React.createElement(\"div\",{className:\"col-lg-12\"},React.createElement(\"h4\",{className:\"page-title\"},\"Modification permissions\"))),React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col-sm-12\"},React.createElement(\"div\",{style:{display:'flex',justifyContent:'flex-start',alignItems:'center',marginBottom:'10px',marginLeft:'5px'}},React.createElement(\"h4\",{style:{fontSize:'20px'}},\"Role : \",this.state.role)),React.createElement(\"div\",{className:\"white-box\"},React.createElement(\"div\",{style:{display:'flex',justifyContent:'flex-start',alignItems:'center',marginBottom:'10px',marginRight:'20px'}},React.createElement(Link,{to:\"/Roles\"},\" \",React.createElement(\"button\",{style:{background:'#DC143C',border:'1px solid #DC143C',borderRadius:'5px'},type:\"button\",className:\"btn btn-info\"},\" \",React.createElement(\"i\",{style:{paddingRight:'5px'},className:\"fas fa-arrow-circle-left\"}),\"Retour\"))),React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"table-responsive\",style:{textAlign:'center'}},React.createElement(\"table\",{className:\"table align-items-center table-flush\"},React.createElement(\"thead\",{className:\"thead-light\"},React.createElement(\"tr\",null,React.createElement(\"th\",{style:{textAlign:'center'},scope:\"col\"},\"Services\"),React.createElement(\"th\",{style:{textAlign:'center'},scope:\"col\"},\"Ajouter\"),React.createElement(\"th\",{style:{textAlign:'center'},scope:\"col\"},\"Explorer\"),React.createElement(\"th\",{style:{textAlign:'center'},scope:\"col\"},\"Modifier\"),React.createElement(\"th\",{style:{textAlign:'center'},scope:\"col\"},\"Supprimer\"))),this.state.services.map(function(el){return React.createElement(\"tbody\",null,React.createElement(\"tr\",null,React.createElement(\"td\",null,el.service),React.createElement(\"td\",null,React.createElement(\"input\",{className:\"add\",type:\"checkbox\"})),React.createElement(\"td\",null,React.createElement(\"input\",{className:\"view\",type:\"checkbox\"})),React.createElement(\"td\",null,React.createElement(\"input\",{className:\"Update\",type:\"checkbox\"})),React.createElement(\"td\",null,React.createElement(\"input\",{className:\"delet\",type:\"checkbox\"}))));}))),React.createElement(\"div\",{style:{display:'flex',justifyContent:'center',marginBottom:'10px'}},React.createElement(\"button\",{style:{borderRadius:'5px'},type:\"button\",className:\"btn btn-success\",onClick:this.modif},\"Confirmer\"))))))));}}]);return Permissions;}(Component);export default withRouter(Permissions);","map":{"version":3,"sources":["C:/wamp/www/art_metiers_prod/mediatraining/src/Permissions.js"],"names":["React","Component","Link","BrowserRouter","Router","Route","Switch","withRouter","axios","jQuery","Permissions","props","modif","canAdd","canRead","canUpdate","canDelete","ajout","document","getElementsByClassName","explorer","modifier","supprimer","longeur","state","services","length","tabPermission","i","checked","idRole","location","objetPermission","service_id","id","role_id","ajouter","console","log","push","ajax","url","process","env","REACT_APP_API_URL","type","data","dataType","success","code_html","statut","Result","history","alert","permissions","role","JSON","parse","localStorage","getItem","get","then","res","setState","long","addCan","readCan","updateCan","deleteCan","j","minHeight","marginLeft","display","justifyContent","alignItems","marginBottom","fontSize","marginRight","background","border","borderRadius","paddingRight","textAlign","map","el","service"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Link, BrowserRouter as Router, Route, Switch, withRouter } from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport jQuery from 'jquery'\r\n\r\nclass Permissions extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            services: [],\r\n            permissions: [],\r\n            role: ''\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (JSON.parse((localStorage.getItem('userPermissions'))) != null) {\r\n            axios.get(process.env.REACT_APP_API_URL + 'Back_mediatraining/Services.php').then(res => {\r\n                this.setState({ services: res.data }, () => {\r\n                    let idRole = this.props.location.state.idRole;\r\n                    axios.get(process.env.REACT_APP_API_URL + 'Back_mediatraining/GetPermissionByRoleId.php?id=' + idRole).then(res => {\r\n                        this.setState({\r\n                            role: res.data[0].role,\r\n                            permissions: res.data\r\n                        },\r\n                            () => {\r\n                                var long = this.state.permissions.length\r\n                                var ajout = document.getElementsByClassName('add')\r\n                                console.log(ajout)\r\n                                var addCan = []\r\n                                var explorer = document.getElementsByClassName('view')\r\n                                console.log(explorer)\r\n                                var readCan = []\r\n                                var modifier = document.getElementsByClassName('Update')\r\n                                console.log(modifier)\r\n                                var updateCan = []\r\n                                var supprimer = document.getElementsByClassName('delet')\r\n                                console.log(supprimer)\r\n                                var deleteCan = []\r\n\r\n                                for (var i = 0; i < long; i++) {\r\n                                    addCan.push(this.state.permissions[i].ajouter)\r\n                                    readCan.push(this.state.permissions[i].explorer)\r\n                                    updateCan.push(this.state.permissions[i].modifier)\r\n                                    deleteCan.push(this.state.permissions[i].supprimer)\r\n                                }\r\n\r\n                                console.log('le tableau addCan')\r\n                                console.log(addCan)\r\n                                console.log('le tableau readCan')\r\n                                console.log(readCan)\r\n                                console.log('le tableau updateCan')\r\n                                console.log(updateCan)\r\n                                console.log('le tableau deleteCan')\r\n                                console.log(deleteCan)\r\n\r\n                                for (var j = 0; j < long; j++) {\r\n                                    if (addCan[j] == 1) {\r\n                                        ajout[j].checked = true\r\n                                    }\r\n                                    else if (addCan[j] == 0) {\r\n                                        ajout[j].checked = false\r\n                                    }\r\n                                    if (readCan[j] == 1) {\r\n                                        explorer[j].checked = true\r\n                                    }\r\n                                    else if (readCan[j] == 0) {\r\n                                        explorer[j].checked = false\r\n                                    }\r\n                                    if (updateCan[j] == 1) {\r\n                                        modifier[j].checked = true\r\n                                    }\r\n                                    else if (updateCan[j] == 0) {\r\n                                        modifier[j].checked = false\r\n                                    }\r\n                                    if (deleteCan[j] == 1) {\r\n                                        supprimer[j].checked = true\r\n                                    }\r\n                                    else if (deleteCan[j] == 0) {\r\n                                        supprimer[j].checked = false\r\n                                    }\r\n                                }\r\n                            }\r\n                        );\r\n                    });\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    modif = () => {\r\n        ///\r\n        var canAdd = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        var canRead = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        var canUpdate = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        var canDelete = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        ///\r\n        var ajout = document.getElementsByClassName('add')\r\n        var explorer = document.getElementsByClassName('view')\r\n        var modifier = document.getElementsByClassName('Update')\r\n        var supprimer = document.getElementsByClassName('delet')\r\n        var longeur = this.state.services.length\r\n        var tabPermission = []\r\n\r\n        for (var i = 0; i < longeur; i++) {\r\n            if (ajout[i].checked) {\r\n                canAdd[i] = 1\r\n            }\r\n            else if (ajout[i].checked === false) {\r\n                canAdd[i] = 0\r\n            }\r\n            if (explorer[i].checked) {\r\n                canRead[i] = 1\r\n            }\r\n            else if (explorer[i].checked === false) {\r\n                canRead[i] = 0\r\n            }\r\n            if (modifier[i].checked) {\r\n                canUpdate[i] = 1\r\n            }\r\n            else if (modifier[i].checked === false) {\r\n                canUpdate[i] = 0\r\n            }\r\n            if (supprimer[i].checked) {\r\n                canDelete[i] = 1\r\n            }\r\n            else if (supprimer[i].checked === false) {\r\n                canDelete[i] = 0\r\n            }\r\n\r\n            var idRole = this.props.location.state.idRole;\r\n            var objetPermission = { service_id: this.state.services[i].id, role_id: idRole, ajouter: canAdd[i], explorer: canRead[i], modifier: canUpdate[i], supprimer: canDelete[i] }\r\n            console.log(objetPermission)\r\n            tabPermission.push(objetPermission)\r\n        }\r\n        console.log(tabPermission)\r\n\r\n        jQuery.ajax({\r\n            url: process.env.REACT_APP_API_URL + 'Back_mediatraining/UpdPermissionByRoleId.php?id=' + idRole,\r\n            type: 'POST',\r\n            data: {\r\n                tabPermission: tabPermission\r\n            },\r\n            dataType: 'json',\r\n            success: (code_html, statut) => {\r\n                if (code_html.Result === \"OK\") {\r\n                    this.props.history.push('/Roles');\r\n                }\r\n                else if (code_html.Result === \"KO\") {\r\n                    alert(\"erreur,l'un de vos champs est vide!!\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div id=\"page-wrapper\" style={{ minHeight: '263px', marginLeft: '0px' }}>\r\n                <div className=\"container-fluid\">\r\n                    <div className=\"row bg-title\">\r\n                        <div className=\"col-lg-12\">\r\n                            <h4 className=\"page-title\">Modification permissions</h4>\r\n                        </div>\r\n                        {/* /.col-lg-12 */}\r\n                    </div>\r\n                    {/* /.row */}\r\n                    <div className=\"row\">\r\n                        <div className=\"col-sm-12\">\r\n                            <div style={{ display: 'flex', justifyContent: 'flex-start', alignItems: 'center', marginBottom: '10px', marginLeft: '5px' }}>\r\n                                <h4 style={{ fontSize: '20px' }}>Role : {this.state.role}</h4>\r\n                            </div>\r\n                            <div className=\"white-box\">\r\n                                <div style={{ display: 'flex', justifyContent: 'flex-start', alignItems: 'center', marginBottom: '10px', marginRight: '20px' }}>\r\n                                    <Link to=\"/Roles\" > <button style={{ background: '#DC143C', border: '1px solid #DC143C', borderRadius: '5px' }} type=\"button\" className=\"btn btn-info\"> <i style={{ paddingRight: '5px' }} className=\"fas fa-arrow-circle-left\"></i>Retour</button></Link>\r\n                                </div>\r\n                                <div className=\"row\">\r\n                                    <div className=\"table-responsive\" style={{ textAlign: 'center' }}>\r\n                                        <table className=\"table align-items-center table-flush\">\r\n                                            <thead className=\"thead-light\">\r\n                                                <tr>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Services</th>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Ajouter</th>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Explorer</th>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Modifier</th>\r\n                                                    <th style={{ textAlign: 'center' }} scope=\"col\">Supprimer</th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            {this.state.services.map(el =>\r\n                                                <tbody>\r\n                                                    <tr>\r\n                                                        <td>\r\n                                                            {el.service}\r\n                                                        </td>\r\n                                                        <td>\r\n                                                            <input className='add' type=\"checkbox\" />\r\n                                                        </td>\r\n                                                        <td>\r\n                                                            <input className='view' type=\"checkbox\" />\r\n                                                        </td>\r\n                                                        <td>\r\n                                                            <input className='Update' type=\"checkbox\" />\r\n                                                        </td>\r\n                                                        <td>\r\n                                                            <input className='delet' type=\"checkbox\" />\r\n                                                        </td>\r\n                                                    </tr>\r\n                                                </tbody>\r\n                                            )}\r\n                                        </table>\r\n                                    </div>\r\n                                    <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '10px' }}>\r\n                                        <button style={{ borderRadius: '5px' }} type=\"button\" className=\"btn btn-success\" onClick={this.modif}>Confirmer</button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(Permissions);"]},"metadata":{},"sourceType":"module"}